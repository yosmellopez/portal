{"remainingRequest":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\thread-loader\\dist\\cjs.js??ref--9-2!D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\ts-loader\\index.js??ref--9-3!D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\eslint-loader\\dist\\cjs.js!D:\\Programacion\\EspacioPHP\\portalventura\\frontend\\app\\core\\auth\\auth-jwt.service.ts","dependencies":[{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\frontend\\app\\core\\auth\\auth-jwt.service.ts","mtime":1580832355264},{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\angular2-template-loader\\index.js","mtime":1486570058000},{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\eslint-loader\\dist\\cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF9hLCBfYiwgX2M7DQppbXBvcnQgKiBhcyB0c2xpYl8xIGZyb20gInRzbGliIjsNCmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJzsNCmltcG9ydCB7IEh0dHBDbGllbnQgfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7DQppbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7DQovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVudXNlZC12YXJzDQppbXBvcnQgeyBtYXAgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7DQppbXBvcnQgeyBMb2NhbFN0b3JhZ2VTZXJ2aWNlLCBTZXNzaW9uU3RvcmFnZVNlcnZpY2UgfSBmcm9tICduZ3gtd2Vic3RvcmFnZSc7DQppbXBvcnQgeyBTRVJWRVJfQVBJX1VSTCB9IGZyb20gJ2FwcC9hcHAuY29uc3RhbnRzJzsNCmxldCBBdXRoU2VydmVyUHJvdmlkZXIgPSBjbGFzcyBBdXRoU2VydmVyUHJvdmlkZXIgew0KICAgIGNvbnN0cnVjdG9yKGh0dHAsICRsb2NhbFN0b3JhZ2UsICRzZXNzaW9uU3RvcmFnZSkgew0KICAgICAgICB0aGlzLmh0dHAgPSBodHRwOw0KICAgICAgICB0aGlzLiRsb2NhbFN0b3JhZ2UgPSAkbG9jYWxTdG9yYWdlOw0KICAgICAgICB0aGlzLiRzZXNzaW9uU3RvcmFnZSA9ICRzZXNzaW9uU3RvcmFnZTsNCiAgICB9DQogICAgZ2V0VG9rZW4oKSB7DQogICAgICAgIHJldHVybiB0aGlzLiRsb2NhbFN0b3JhZ2UucmV0cmlldmUoJ2F1dGhlbnRpY2F0aW9uVG9rZW4nKSB8fCB0aGlzLiRzZXNzaW9uU3RvcmFnZS5yZXRyaWV2ZSgnYXV0aGVudGljYXRpb25Ub2tlbicpOw0KICAgIH0NCiAgICBsb2dpbihjcmVkZW50aWFscykgew0KICAgICAgICBjb25zdCBkYXRhID0gew0KICAgICAgICAgICAgbm9tYlVzdWFyaW86IGNyZWRlbnRpYWxzLm5vbWJVc3VhcmlvLA0KICAgICAgICAgICAgY2xhdmVVc3VhcmlvOiBjcmVkZW50aWFscy5jbGF2ZVVzdWFyaW8sDQogICAgICAgICAgICByZW1lbWJlck1lOiBjcmVkZW50aWFscy5yZW1lbWJlck1lDQogICAgICAgIH07DQogICAgICAgIGZ1bmN0aW9uIGF1dGhlbnRpY2F0ZVN1Y2Nlc3MocmVzcCkgew0KICAgICAgICAgICAgY29uc3QgYmVhcmVyVG9rZW4gPSByZXNwLmhlYWRlcnMuZ2V0KCdhdXRob3JpemF0aW9uJyk7DQogICAgICAgICAgICBpZiAoYmVhcmVyVG9rZW4pIHsNCiAgICAgICAgICAgICAgICBjb25zdCBqd3QgPSBiZWFyZXJUb2tlbjsNCiAgICAgICAgICAgICAgICB0aGlzLnN0b3JlQXV0aGVudGljYXRpb25Ub2tlbihqd3QsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gand0Ow0KICAgICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiB0aGlzLmh0dHAucG9zdChTRVJWRVJfQVBJX1VSTCArICdhcGkvYXV0aGVudGljYXRlJywgZGF0YSwgeyBvYnNlcnZlOiAncmVzcG9uc2UnIH0pLnBpcGUobWFwKGF1dGhlbnRpY2F0ZVN1Y2Nlc3MuYmluZCh0aGlzKSkpOw0KICAgIH0NCiAgICBsb2dpbldpdGhUb2tlbihqd3QsIHJlbWVtYmVyTWUpIHsNCiAgICAgICAgaWYgKGp3dCkgew0KICAgICAgICAgICAgdGhpcy5zdG9yZUF1dGhlbnRpY2F0aW9uVG9rZW4oand0LCByZW1lbWJlck1lKTsNCiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoand0KTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdCgnYXV0aC1qd3Qtc2VydmljZSBQcm9taXNlIHJlamVjdCcpOyAvLyBQdXQgYXBwcm9wcmlhdGUgZXJyb3IgbWVzc2FnZSBoZXJlDQogICAgICAgIH0NCiAgICB9DQogICAgc3RvcmVBdXRoZW50aWNhdGlvblRva2VuKGp3dCwgcmVtZW1iZXJNZSkgew0KICAgICAgICBpZiAocmVtZW1iZXJNZSkgew0KICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2F1dGhlbnRpY2F0aW9uVG9rZW4nLCBqd3QpOw0KICAgICAgICAgICAgdGhpcy4kbG9jYWxTdG9yYWdlLnN0b3JlKCdhdXRoZW50aWNhdGlvblRva2VuJywgand0KTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHNlc3Npb25TdG9yYWdlLnNldEl0ZW0oJ2F1dGhlbnRpY2F0aW9uVG9rZW4nLCBqd3QpOw0KICAgICAgICAgICAgdGhpcy4kc2Vzc2lvblN0b3JhZ2Uuc3RvcmUoJ2F1dGhlbnRpY2F0aW9uVG9rZW4nLCBqd3QpOw0KICAgICAgICB9DQogICAgfQ0KICAgIGxvZ291dCgpIHsNCiAgICAgICAgcmV0dXJuIG5ldyBPYnNlcnZhYmxlKG9ic2VydmVyID0+IHsNCiAgICAgICAgICAgIHRoaXMuJGxvY2FsU3RvcmFnZS5jbGVhcignYXV0aGVudGljYXRpb25Ub2tlbicpOw0KICAgICAgICAgICAgdGhpcy4kc2Vzc2lvblN0b3JhZ2UuY2xlYXIoJ2F1dGhlbnRpY2F0aW9uVG9rZW4nKTsNCiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJhdXRoZW50aWNhdGlvblRva2VuIik7DQogICAgICAgICAgICBzZXNzaW9uU3RvcmFnZS5yZW1vdmVJdGVtKCJhdXRoZW50aWNhdGlvblRva2VuIik7DQogICAgICAgICAgICBvYnNlcnZlci5jb21wbGV0ZSgpOw0KICAgICAgICB9KTsNCiAgICB9DQp9Ow0KQXV0aFNlcnZlclByb3ZpZGVyID0gdHNsaWJfMS5fX2RlY29yYXRlKFsNCiAgICBJbmplY3RhYmxlKHsgcHJvdmlkZWRJbjogJ3Jvb3QnIH0pLA0KICAgIHRzbGliXzEuX19tZXRhZGF0YSgiZGVzaWduOnBhcmFtdHlwZXMiLCBbdHlwZW9mIChfYSA9IHR5cGVvZiBIdHRwQ2xpZW50ICE9PSAidW5kZWZpbmVkIiAmJiBIdHRwQ2xpZW50KSA9PT0gImZ1bmN0aW9uIiA/IF9hIDogT2JqZWN0LCB0eXBlb2YgKF9iID0gdHlwZW9mIExvY2FsU3RvcmFnZVNlcnZpY2UgIT09ICJ1bmRlZmluZWQiICYmIExvY2FsU3RvcmFnZVNlcnZpY2UpID09PSAiZnVuY3Rpb24iID8gX2IgOiBPYmplY3QsIHR5cGVvZiAoX2MgPSB0eXBlb2YgU2Vzc2lvblN0b3JhZ2VTZXJ2aWNlICE9PSAidW5kZWZpbmVkIiAmJiBTZXNzaW9uU3RvcmFnZVNlcnZpY2UpID09PSAiZnVuY3Rpb24iID8gX2MgOiBPYmplY3RdKQ0KXSwgQXV0aFNlcnZlclByb3ZpZGVyKTsNCmV4cG9ydCB7IEF1dGhTZXJ2ZXJQcm92aWRlciB9Ow0K"},{"version":3,"file":"D:\\Programacion\\EspacioPHP\\portalventura\\frontend\\app\\core\\auth\\auth-jwt.service.ts","sourceRoot":"","sources":["D:\\Programacion\\EspacioPHP\\portalventura\\node_modules\\eslint-loader\\dist\\cjs.js!D:\\Programacion\\EspacioPHP\\portalventura\\frontend\\app\\core\\auth\\auth-jwt.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { map } from 'rxjs/operators';\r\nimport { LocalStorageService, SessionStorageService } from 'ngx-webstorage';\r\n\r\nimport { SERVER_API_URL } from 'app/app.constants';\r\n\r\n@Injectable({providedIn: 'root'})\r\nexport class AuthServerProvider {\r\n    constructor(private http: HttpClient, private $localStorage: LocalStorageService, private $sessionStorage: SessionStorageService) {\r\n    }\r\n\r\n    getToken() {\r\n        return this.$localStorage.retrieve('authenticationToken') || this.$sessionStorage.retrieve('authenticationToken');\r\n    }\r\n\r\n    login(credentials): Observable<any> {\r\n        const data = {\r\n            nombUsuario: credentials.nombUsuario,\r\n            claveUsuario: credentials.claveUsuario,\r\n            rememberMe: credentials.rememberMe\r\n        };\r\n\r\n        function authenticateSuccess(resp) {\r\n            const bearerToken = resp.headers.get('authorization');\r\n            if (bearerToken) {\r\n                const jwt = bearerToken;\r\n                this.storeAuthenticationToken(jwt, false);\r\n                return jwt;\r\n            }\r\n        }\r\n\r\n        return this.http.post(SERVER_API_URL + 'api/authenticate', data, {observe: 'response'}).pipe(map(authenticateSuccess.bind(this)));\r\n    }\r\n\r\n    loginWithToken(jwt, rememberMe) {\r\n        if (jwt) {\r\n            this.storeAuthenticationToken(jwt, rememberMe);\r\n            return Promise.resolve(jwt);\r\n        } else {\r\n            return Promise.reject('auth-jwt-service Promise reject'); // Put appropriate error message here\r\n        }\r\n    }\r\n\r\n    storeAuthenticationToken(jwt, rememberMe) {\r\n        if (rememberMe) {\r\n            localStorage.setItem('authenticationToken', jwt);\r\n            this.$localStorage.store('authenticationToken', jwt);\r\n        } else {\r\n            sessionStorage.setItem('authenticationToken', jwt);\r\n            this.$sessionStorage.store('authenticationToken', jwt);\r\n        }\r\n    }\r\n\r\n    logout(): Observable<any> {\r\n        return new Observable(observer => {\r\n            this.$localStorage.clear('authenticationToken');\r\n            this.$sessionStorage.clear('authenticationToken');\r\n            localStorage.removeItem(\"authenticationToken\");\r\n            sessionStorage.removeItem(\"authenticationToken\");\r\n            observer.complete();\r\n        });\r\n    }\r\n}\r\n"]}]}