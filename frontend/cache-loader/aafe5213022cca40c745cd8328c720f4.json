{"remainingRequest":"C:\\wamp64\\www\\portal\\node_modules\\thread-loader\\dist\\cjs.js??ref--9-2!C:\\wamp64\\www\\portal\\node_modules\\ts-loader\\index.js??ref--9-3!C:\\wamp64\\www\\portal\\node_modules\\eslint-loader\\dist\\cjs.js!C:\\wamp64\\www\\portal\\frontend\\app\\core\\auth\\user-route-access-service.ts","dependencies":[{"path":"C:\\wamp64\\www\\portal\\frontend\\app\\core\\auth\\user-route-access-service.ts","mtime":1569967305596},{"path":"C:\\wamp64\\www\\portal\\node_modules\\angular2-template-loader\\index.js","mtime":1486570058000},{"path":"C:\\wamp64\\www\\portal\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\wamp64\\www\\portal\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\wamp64\\www\\portal\\node_modules\\ts-loader\\index.js","mtime":499162500000},{"path":"C:\\wamp64\\www\\portal\\node_modules\\eslint-loader\\dist\\cjs.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICogYXMgdHNsaWJfMSBmcm9tICJ0c2xpYiI7DQp2YXIgX2EsIF9iLCBfYywgX2QsIF9lOw0KaW1wb3J0IHsgSW5qZWN0YWJsZSwgaXNEZXZNb2RlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7DQppbXBvcnQgeyBSb3V0ZXIgfSBmcm9tICdAYW5ndWxhci9yb3V0ZXInOw0KaW1wb3J0IHsgQWNjb3VudFNlcnZpY2UgfSBmcm9tICdhcHAvY29yZS9hdXRoL2FjY291bnQuc2VydmljZSc7DQppbXBvcnQgeyBMb2dpbk1vZGFsU2VydmljZSB9IGZyb20gJ2FwcC9jb3JlL2xvZ2luL2xvZ2luLW1vZGFsLnNlcnZpY2UnOw0KaW1wb3J0IHsgU3RhdGVTdG9yYWdlU2VydmljZSB9IGZyb20gJy4vc3RhdGUtc3RvcmFnZS5zZXJ2aWNlJzsNCmltcG9ydCB7IE1hdERpYWxvZyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7DQppbXBvcnQgeyBKaGlMb2dpbk1vZGFsQ29tcG9uZW50IH0gZnJvbSAnYXBwL3NoYXJlZC9sb2dpbi9sb2dpbi5jb21wb25lbnQnOw0KbGV0IFVzZXJSb3V0ZUFjY2Vzc1NlcnZpY2UgPSBjbGFzcyBVc2VyUm91dGVBY2Nlc3NTZXJ2aWNlIHsNCiAgICBjb25zdHJ1Y3Rvcihyb3V0ZXIsIGxvZ2luTW9kYWxTZXJ2aWNlLCBhY2NvdW50U2VydmljZSwgc3RhdGVTdG9yYWdlU2VydmljZSwgZGlhbG9nKSB7DQogICAgICAgIHRoaXMucm91dGVyID0gcm91dGVyOw0KICAgICAgICB0aGlzLmxvZ2luTW9kYWxTZXJ2aWNlID0gbG9naW5Nb2RhbFNlcnZpY2U7DQogICAgICAgIHRoaXMuYWNjb3VudFNlcnZpY2UgPSBhY2NvdW50U2VydmljZTsNCiAgICAgICAgdGhpcy5zdGF0ZVN0b3JhZ2VTZXJ2aWNlID0gc3RhdGVTdG9yYWdlU2VydmljZTsNCiAgICAgICAgdGhpcy5kaWFsb2cgPSBkaWFsb2c7DQogICAgfQ0KICAgIGNhbkFjdGl2YXRlKHJvdXRlLCBzdGF0ZSkgew0KICAgICAgICBjb25zdCBhdXRob3JpdGllcyA9IHJvdXRlLmRhdGFbJ2F1dGhvcml0aWVzJ107DQogICAgICAgIHJldHVybiB0aGlzLmNoZWNrTG9naW4oYXV0aG9yaXRpZXMsIHN0YXRlLnVybCk7DQogICAgfQ0KICAgIGNoZWNrTG9naW4oYXV0aG9yaXRpZXMsIHVybCkgew0KICAgICAgICByZXR1cm4gdGhpcy5hY2NvdW50U2VydmljZS5pZGVudGl0eSgpLnRoZW4oYWNjb3VudCA9PiB7DQogICAgICAgICAgICBpZiAoIWF1dGhvcml0aWVzIHx8IGF1dGhvcml0aWVzLmxlbmd0aCA9PT0gMCkgew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYgKGFjY291bnQpIHsNCiAgICAgICAgICAgICAgICBjb25zdCBoYXNBbnlBdXRob3JpdHkgPSB0aGlzLmFjY291bnRTZXJ2aWNlLmhhc0FueUF1dGhvcml0eShhdXRob3JpdGllcyk7DQogICAgICAgICAgICAgICAgaWYgKGhhc0FueUF1dGhvcml0eSkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgaWYgKGlzRGV2TW9kZSgpKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1VzZXIgaGFzIG5vdCBhbnkgb2YgcmVxdWlyZWQgYXV0aG9yaXRpZXM6ICcsIGF1dGhvcml0aWVzKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgdGhpcy5yb3V0ZXIubmF2aWdhdGUoWycvYWNjZXNzZGVuaWVkJ10pOw0KICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgICAgIHRoaXMuc3RhdGVTdG9yYWdlU2VydmljZS5zdG9yZVVybCh1cmwpOw0KICAgICAgICAgICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnL3NpZ25pbiddKTsNCiAgICAgICAgICAgICAgICBjb25zdCBkaWFsb2dSZWYgPSB0aGlzLmRpYWxvZy5vcGVuKEpoaUxvZ2luTW9kYWxDb21wb25lbnQsIHsgd2lkdGg6ICc0NTBweCcgfSk7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICB9DQp9Ow0KVXNlclJvdXRlQWNjZXNzU2VydmljZSA9IHRzbGliXzEuX19kZWNvcmF0ZShbDQogICAgSW5qZWN0YWJsZSh7IHByb3ZpZGVkSW46ICdyb290JyB9KSwNCiAgICB0c2xpYl8xLl9fbWV0YWRhdGEoImRlc2lnbjpwYXJhbXR5cGVzIiwgW3R5cGVvZiAoX2EgPSB0eXBlb2YgUm91dGVyICE9PSAidW5kZWZpbmVkIiAmJiBSb3V0ZXIpID09PSAiZnVuY3Rpb24iID8gX2EgOiBPYmplY3QsIHR5cGVvZiAoX2IgPSB0eXBlb2YgTG9naW5Nb2RhbFNlcnZpY2UgIT09ICJ1bmRlZmluZWQiICYmIExvZ2luTW9kYWxTZXJ2aWNlKSA9PT0gImZ1bmN0aW9uIiA/IF9iIDogT2JqZWN0LCB0eXBlb2YgKF9jID0gdHlwZW9mIEFjY291bnRTZXJ2aWNlICE9PSAidW5kZWZpbmVkIiAmJiBBY2NvdW50U2VydmljZSkgPT09ICJmdW5jdGlvbiIgPyBfYyA6IE9iamVjdCwgdHlwZW9mIChfZCA9IHR5cGVvZiBTdGF0ZVN0b3JhZ2VTZXJ2aWNlICE9PSAidW5kZWZpbmVkIiAmJiBTdGF0ZVN0b3JhZ2VTZXJ2aWNlKSA9PT0gImZ1bmN0aW9uIiA/IF9kIDogT2JqZWN0LCB0eXBlb2YgKF9lID0gdHlwZW9mIE1hdERpYWxvZyAhPT0gInVuZGVmaW5lZCIgJiYgTWF0RGlhbG9nKSA9PT0gImZ1bmN0aW9uIiA/IF9lIDogT2JqZWN0XSkNCl0sIFVzZXJSb3V0ZUFjY2Vzc1NlcnZpY2UpOw0KZXhwb3J0IHsgVXNlclJvdXRlQWNjZXNzU2VydmljZSB9Ow0K"},{"version":3,"file":"C:\\wamp64\\www\\portal\\frontend\\app\\core\\auth\\user-route-access-service.ts","sourceRoot":"","sources":["C:\\wamp64\\www\\portal\\node_modules\\eslint-loader\\dist\\cjs.js!C:\\wamp64\\www\\portal\\frontend\\app\\core\\auth\\user-route-access-service.ts"],"names":[],"mappings":";;AAAA,OAAO,EAAE,UAAU,EAAE,SAAS,EAAE,MAAM,eAAe,CAAC;AACtD,OAAO,EAAuC,MAAM,EAAuB,MAAM,iBAAiB,CAAC;AAEnG,OAAO,EAAE,cAAc,EAAE,MAAM,+BAA+B,CAAC;AAC/D,OAAO,EAAE,iBAAiB,EAAE,MAAM,oCAAoC,CAAC;AACvE,OAAO,EAAE,mBAAmB,EAAE,MAAM,yBAAyB,CAAC;AAC9D,OAAO,EAAE,SAAS,EAAE,MAAM,0BAA0B,CAAC;AACrD,OAAO,EAAE,sBAAsB,EAAE,MAAM,kCAAkC,CAAC;AAG1E,IAAa,sBAAsB,GAAnC,MAAa,sBAAsB;IAC/B,YACY,MAAc,EACd,iBAAoC,EACpC,cAA8B,EAC9B,mBAAwC,EACxC,MAAiB;QAJjB,WAAM,GAAN,MAAM,CAAQ;QACd,sBAAiB,GAAjB,iBAAiB,CAAmB;QACpC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,WAAM,GAAN,MAAM,CAAW;IAE7B,CAAC;IAED,WAAW,CAAC,KAA6B,EAAE,KAA0B;QACjE,MAAM,WAAW,GAAG,KAAK,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QAC9C,OAAO,IAAI,CAAC,UAAU,CAAC,WAAW,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC;IACnD,CAAC;IAED,UAAU,CAAC,WAAqB,EAAE,GAAW;QACzC,OAAO,IAAI,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;YACjD,IAAI,CAAC,WAAW,IAAI,WAAW,CAAC,MAAM,KAAK,CAAC,EAAE;gBAC1C,OAAO,IAAI,CAAC;aACf;YAED,IAAI,OAAO,EAAE;gBACT,MAAM,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,WAAW,CAAC,CAAC;gBACzE,IAAI,eAAe,EAAE;oBACjB,OAAO,IAAI,CAAC;iBACf;gBACD,IAAI,SAAS,EAAE,EAAE;oBACb,OAAO,CAAC,KAAK,CAAC,4CAA4C,EAAE,WAAW,CAAC,CAAC;iBAC5E;gBACD,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC;gBACxC,OAAO,KAAK,CAAC;aAChB;iBAAM;gBACH,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,GAAG,CAAC,CAAC;gBACvC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,SAAS,CAAC,CAAC,CAAC;gBAClC,MAAM,SAAS,GAAG,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,sBAAsB,EAAE,EAAC,KAAK,EAAE,OAAO,EAAC,CAAC,CAAC;gBAC7E,OAAO,KAAK,CAAC;aAChB;QACL,CAAC,CAAC,CAAC;IACP,CAAC;CACJ,CAAA;AAvCY,sBAAsB;IADlC,UAAU,CAAC,EAAC,UAAU,EAAE,MAAM,EAAC,CAAC;iEAGT,MAAM,oBAAN,MAAM,oDACK,iBAAiB,oBAAjB,iBAAiB,oDACpB,cAAc,oBAAd,cAAc,oDACT,mBAAmB,oBAAnB,mBAAmB,oDAChC,SAAS,oBAAT,SAAS;GANpB,sBAAsB,CAuClC;SAvCY,sBAAsB","sourcesContent":["import { Injectable, isDevMode } from '@angular/core';\nimport { ActivatedRouteSnapshot, CanActivate, Router, RouterStateSnapshot } from '@angular/router';\n\nimport { AccountService } from 'app/core/auth/account.service';\nimport { LoginModalService } from 'app/core/login/login-modal.service';\nimport { StateStorageService } from './state-storage.service';\nimport { MatDialog } from '@angular/material/dialog';\nimport { JhiLoginModalComponent } from 'app/shared/login/login.component';\n\n@Injectable({providedIn: 'root'})\nexport class UserRouteAccessService implements CanActivate {\n    constructor(\n        private router: Router,\n        private loginModalService: LoginModalService,\n        private accountService: AccountService,\n        private stateStorageService: StateStorageService,\n        private dialog: MatDialog\n    ) {\n    }\n\n    canActivate(route: ActivatedRouteSnapshot, state: RouterStateSnapshot): boolean | Promise<boolean> {\n        const authorities = route.data['authorities'];\n        return this.checkLogin(authorities, state.url);\n    }\n\n    checkLogin(authorities: string[], url: string): Promise<boolean> {\n        return this.accountService.identity().then(account => {\n            if (!authorities || authorities.length === 0) {\n                return true;\n            }\n\n            if (account) {\n                const hasAnyAuthority = this.accountService.hasAnyAuthority(authorities);\n                if (hasAnyAuthority) {\n                    return true;\n                }\n                if (isDevMode()) {\n                    console.error('User has not any of required authorities: ', authorities);\n                }\n                this.router.navigate(['/accessdenied']);\n                return false;\n            } else {\n                this.stateStorageService.storeUrl(url);\n                this.router.navigate(['/signin']);\n                const dialogRef = this.dialog.open(JhiLoginModalComponent, {width: '450px'});\n                return false;\n            }\n        });\n    }\n}\n"]}]}